<h1 dir="auto">Shield</h1>
<p dir="auto">Shield is an extremely simple mechanism to forbid running of potentially harmful codes.</p>
<p dir="auto">Shield is not a sandboxing solution. Shield provides only a partial protection against trivial attacks. Real protection against untrusted code comes only by enabling <a href="sandboxing.md">Sandbox</a>.</p>
<h2 dir="auto">Shield for C/C++</h2>
<p dir="auto">By enabling Shield for C/C++, Sharif Judge just adds some <code>#define</code>s at the beginning of submitted C/C++ code before running.</p>
<p dir="auto">For example we can forbid using <code>goto</code> by adding this line at the beginning of submitted code:</p>
<pre><code class="language-c">#define goto YouCannotUseGoto</code></pre>
<p dir="auto">With this line at the beginning of files, all submitted codes which use <code>goto</code> will get a compilation error.</p>
<p dir="auto">If you enable Shield, any code that contains <code>#undef</code> will get a compilation error.</p>
<h3 dir="auto">Enabling Shield for C or C++</h3>
<p dir="auto">You can enable or disable Shield in <code>Settings</code> page.</p>
<h3 dir="auto">Adding Rules for C/C++</h3>
<p dir="auto">List of <code>#define</code> rules is located in files <code>tester/shield/defc.h</code> (for C) and <code>tester/shield/defcpp.h</code> (for C++). You can add new <code>#define</code> rules in these files. The contents of these files is editable in <code>Settings</code> page.</p>
<p dir="auto">The syntax used in these files is like this:</p>
<pre><code class="language-c">/*

@file defc.h
There should be a newline at end of this file.
Put the message displayed to user after // in each line

e.g. If you want to disallow goto, add this line:
#define goto errorNo13    //Goto is not allowd

*/

#define system errorNo1      //"system" is not allowed
#define freopen errorNo2     //File operation is not allowed
#define fopen errorNo3       //File operation is not allowed
#define fprintf errorNo4     //File operation is not allowed
#define fscanf errorNo5      //File operation is not allowed
#define feof errorNo6        //File operation is not allowed
#define fclose errorNo7      //File operation is not allowed
#define ifstream errorNo8    //File operation is not allowed
#define ofstream errorNo9    //File operation is not allowed
#define fork errorNo10       //Fork is not allowed
#define clone errorNo11      //Clone is not allowed
#define sleep errorNo12      //Sleep is not allowed</code></pre>
<p dir="auto">There should be a newline at the end of files <code>defc.h</code> and <code>defcpp.h</code>.</p>
<p dir="auto">Note that lots of these rules are not usable in g++. For example we cannot use <code>#define fopen errorNo3</code> for C++. Because it results in compile error.</p>
<h2 dir="auto">Shield for Python</h2>
<p dir="auto">By enabling Shield for Python, Sharif Judge just adds some code at the beginning of submitted Python code before running to prevent using dangerous functions. These codes are located in files <code>tester/shield/shield_py2.py</code> and <code>tester/shield/shield_py3.py</code>.</p>
<p dir="auto">You can enable/disable Shield for Python in Settings.</p>
<p dir="auto">There are ways to escape from Shield in python and use blacklisted functions!</p>
<pre><code class="language-python"># @file shield_py3.py

import sys
sys.modules['os']=None

BLACKLIST = [
  #'__import__', # deny importing modules
  'eval', # eval is evil
  'open',
  'file',
  'exec',
  'execfile',
  'compile',
  'reload',
  #'input'
  ]
for func in BLACKLIST:
  if func in __builtins__.__dict__:
    del __builtins__.__dict__[func]</code></pre>